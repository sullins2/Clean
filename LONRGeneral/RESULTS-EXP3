
# New Results 5-22

Changed exp3gamma = 0.15

totalIters = 8000

New grid I am using:

 self.grid = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',
              ' ', -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1]

no living cost

exp3 settings: minReward = -1, maxReward = 1

Final pi's, pi sums (i add only the left side of equation, seems ok, lags behind pi)
State 0 is doing that thing where it doesn't have a reason to prefer right to up without a living cost

So this so far is all about the same as before.

I've been looking at the data and the point at which the overflow happens is when pi starts to become optimal.
I believe this is what you were referring to and is causing things like 1 / 0.001 or whatever

This is what I have been trying to do:


        minW = self.M.weights[0][currentState][0]
        aa = 0
        for w in self.M.weights[0][currentState].keys():
            if self.M.weights[0][currentState][w] < minW:
                minW = self.M.weights[0][currentState][w]
            aa += 1

        # This is modulo cause done every time doesn't work
        if t % 1000 == 0:
            self.M.weights[0][currentState][choice] = self.M.weights[0][currentState][choice] - minW
            if self.M.weights[0][currentState][choice] < 1.0:
                self.M.weights[0][currentState][choice] = 1.0



But weights are still like this:

Iteration:  9000
Current state:  11
Weights:  [1.306971831934816e+74, 7.813347762948239e+72, 4.573980257335939e+79, 6.470849768490397e+47]


Finish Training
Pi
PI:  0 :  {0: 0.06274323291254519, 1: 0.8049283110221197, 2: 0.06903823134526955, 3: 0.06329022472006558}
PI:  1 :  {0: 0.06447526912971642, 1: 0.8368486441720564, 2: 0.03439668442059108, 3: 0.06427940227763594}
PI:  2 :  {0: 0.06596703176611017, 1: 0.8354637454067994, 2: 0.03429687709146132, 3: 0.06427234573562904}
PI:  3 :  {0: 0.12530593886106062, 1: 0.7740813138133288, 2: 0.03437775408910754, 3: 0.06623499323650292}
PI:  4 :  {0: 0.06950722271360438, 1: 0.8292904207044304, 2: 0.03394837295413646, 3: 0.06725398362782867}
PI:  5 :  {0: 0.07167913838479137, 1: 0.8149454208596469, 2: 0.03388143979014714, 3: 0.07949400096541467}
PI:  6 :  {0: 0.0737897720968595, 1: 0.8216163149270325, 2: 0.03355568995733319, 3: 0.0710382230187748}
PI:  7 :  {0: 0.11926880339751253, 1: 0.7722865510316176, 2: 0.03369562045838531, 3: 0.07474902511248463}
PI:  8 :  {0: 0.07913659491233377, 1: 0.7453078317950312, 2: 0.0334559783448596, 3: 0.14209959494777538}
PI:  9 :  {0: 0.13416956599000168, 1: 0.7538986155817293, 2: 0.033259627678802244, 3: 0.0786721907494667}
PI:  10 :  {0: 0.08428244669566078, 1: 0.802622570403586, 2: 0.03251768229177046, 3: 0.08057730060898267}
PI:  11 :  {0: 0.082772964571941, 1: 0.08277294158197075, 2: 0.7551727687685783, 3: 0.07928132507750997}
PI:  12 :  {0: 0.5584493289634784, 1: 0.03483132972953742, 2: 0.3440556672095738, 3: 0.06266367409741055}


Q values (not QAvg)
Bottom left (start state)
{0: 0.2498911497527685, 1: -1.0, 2: 0.17452479583878622, 3: 0.17452479583878622}
State above bottom right terminal
{0: 0.9909459477179939, 1: 0.9909459477179939, 2: 1.0, 3: 0.9047487593523247}
PI Sums
PISUM:  0  ( 0 :  0.20484963384642707  1 :  0.32122242632024234  2 :  0.18793024642945655  3 :  0.28599769340387393   )
PISUM:  1  ( 0 :  0.11904374305616404  1 :  0.6911537573111163  2 :  0.062670368565876  3 :  0.12713213106684376   )
PISUM:  2  ( 0 :  0.11298494229788064  1 :  0.6889306190587778  2 :  0.055900705182369705  3 :  0.14218373346097174   )
PISUM:  3  ( 0 :  0.30109317261041735  1 :  0.5807187226304626  2 :  0.04173902147733926  3 :  0.07644908328178059   )
PISUM:  4  ( 0 :  0.054749114652970214  1 :  0.8695288916942339  2 :  0.031602437857455944  3 :  0.04411955579533984   )
PISUM:  5  ( 0 :  0.10302039242268861  1 :  0.7651132106586204  2 :  0.022538041147904152  3 :  0.1093283557707868   )
PISUM:  6  ( 0 :  0.12181222816087577  1 :  0.808594533032685  2 :  0.014388390801123318  3 :  0.05520484800531599   )
PISUM:  7  ( 0 :  0.07039345211988964  1 :  0.8763617288866433  2 :  0.009670481458881375  3 :  0.04357433753458559   )
PISUM:  8  ( 0 :  0.029428377574831882  1 :  0.8287093374364655  2 :  0.007344816609052941  3 :  0.13451746837964984   )
PISUM:  9  ( 0 :  0.16801760192748139  1 :  0.8046930418914876  2 :  0.005433679253739692  3 :  0.021855676927291432   )
PISUM:  10  ( 0 :  0.03495424311626169  1 :  0.9548174294097624  2 :  0.0041231392149126715  3 :  0.00610518825906322   )
PISUM:  11  ( 0 :  0.042900911841954145  1 :  0.2972928308056542  2 :  0.6339707389700058  3 :  0.02583551838238579   )
PISUM:  12  ( 0 :  0.613644124327843  1 :  0.04293945848456521  2 :  0.18319180258247347  3 :  0.1602246146051184   )














########################################################
RESULTS 5-22

note that the grid indices are:

    0   1  2  3  4  5  6  7  8  9 10 11
    12 13 14 15 16 17 18 19 20 21 22 23

So 12 is the start state.
No living cost/reward.

grid is 2x12

self.grid = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',
             ' ', -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 10]


Method:
        Run initially with exp3gamma = 0.5
        Run again with same agent with exp3gamma = 0.0

        PI:  0 :  {0: 3.5815461026299364e-06, 1: 0.9999575829476146, 2: 1.5071248207171754e-14, 3: 3.8835506267613135e-05}
        PI:  1 :  {0: 1.2952749375620447e-10, 1: 0.9999999998702774, 2: 3.3556417346519626e-65, 3: 1.950735971754085e-13}
        PI:  2 :  {0: 1.6030933766447772e-13, 1: 0.9999999999998397, 2: 4.293175997208842e-65, 3: 9.118934840081446e-23}
        PI:  3 :  {0: 2.281581807685738e-10, 1: 0.9999999997718418, 2: 5.7413236979481985e-64, 3: 1.4493351835087946e-18}
        PI:  4 :  {0: 4.865652086027213e-12, 1: 0.9999999999951343, 2: 1.6291976593300664e-63, 3: 3.770919085971272e-23}
        PI:  5 :  {0: 1.5029413916791457e-12, 1: 0.9999999999984971, 2: 3.806721329287463e-64, 3: 2.0241615968407127e-24}
        PI:  6 :  {0: 3.444653124488655e-14, 1: 0.9999999999999656, 2: 3.369985736045202e-65, 3: 2.618807559019651e-26}
        PI:  7 :  {0: 1.024051817133527e-13, 1: 0.9999999999998976, 2: 5.689488805402151e-63, 3: 1.4832738942725603e-21}
        PI:  8 :  {0: 2.3084489456140184e-21, 1: 1.0, 2: 2.4948333180954406e-64, 3: 2.1885343928367825e-26}
        PI:  9 :  {0: 7.428805581502636e-14, 1: 0.9999999999999257, 2: 4.059947615686456e-65, 3: 1.3131791604699664e-22}
        PI:  10 :  {0: 1.6864972483580508e-10, 1: 0.9999999998313504, 2: 1.0215504360796561e-69, 3: 8.951328456430968e-26}
        PI:  11 :  {0: 6.498653221197033e-13, 1: 0.06958495914165776, 2: 0.9304150408576924, 3: 8.341296552643552e-21}
        PI:  12 :  {0: 0.999999999998005, 1: 7.510321124291256e-68, 2: 3.2733692467279805e-13, 3: 1.6676084752109542e-12}
        PI:  13 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  14 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  15 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  16 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  17 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  18 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  19 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  20 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  21 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  22 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
        PI:  23 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}

Q values (not QAvg)
Bottom left (start state)
{0: 10.000000000000002, 1: -1.0, 2: 10.000000000000002, 3: 10.000000000000002}
State above bottom right terminal
{0: 10.000000000000002, 1: 10.000000000000002, 2: 10.0, 3: 10.000000000000004}



















This was run for 40001 iterations (the one is to get the last print out)

note that the grid indices are:

    0   1  2  3  4  5  6  7  8  9 10 11
    12 13 14 15 16 17 18 19 20 21 22 23

So 12 is the start state.
No living cost/reward.

grid is 2x12

self.grid = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',
             ' ', -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 10]

# This prints whatever state it is in at: iteration % 10000
# This isn't being shown for any other reason than it is an example of
# how big the weights get.
Iteration:  40000
Current state:  6
Weights:  [1.6798571052471067e+81, 1.5589074082538363e+95, 1.0470022256029123, 2.1704814344589955e+65]
ProbDist:  [0.12500000000000538, 0.6249999999999946, 0.125, 0.125]
Choice:  2
Reward for choice:  -1.0
Scaled Reward:  0.0
Estimated reward:  0.0
Updating choice:  2
Weights:  {0: 1.6798571052471067e+81, 1: 1.5589074082538363e+95, 2: 1.0470022256029123, 3: 2.1704814344589955e+65}


###################################
# Below is some final data


Finish Training

QAvg for Bottom left (start state)
0 :  -5.491718190156687
1 :  -8.531036724081899
2 :  -6.005496218528585
3 :  -6.005496218528585

Q for Bottom left (start state)
0.1831090236081839
-1.0
-0.01533994567866458
-0.01533994567866458

Pi for Bottom left (start state)
0.625
0.125
0.125
0.125

Pi:
0 :  {0: 0.27921938453059153, 1: 0.2763445466424106, 2: 0.125, 3: 0.31943606882699793}
1 :  {0: 0.125, 1: 0.625, 2: 0.125, 3: 0.125}
2 :  {0: 0.125, 1: 0.625, 2: 0.125, 3: 0.125}
3 :  {0: 0.125, 1: 0.625, 2: 0.125, 3: 0.125}
4 :  {0: 0.125, 1: 0.625, 2: 0.125, 3: 0.125}
5 :  {0: 0.125, 1: 0.625, 2: 0.125, 3: 0.125}
6 :  {0: 0.12500000000000538, 1: 0.6249999999999946, 2: 0.125, 3: 0.125}
7 :  {0: 0.12500000000000114, 1: 0.6249999999999989, 2: 0.125, 3: 0.125}
8 :  {0: 0.12500000000000003, 1: 0.625, 2: 0.125, 3: 0.125}
9 :  {0: 0.125, 1: 0.625, 2: 0.125, 3: 0.125}
10 :  {0: 0.12500000000417524, 1: 0.6249999999958248, 2: 0.125, 3: 0.125}
11 :  {0: 0.12500000000008424, 1: 0.12502020996596533, 2: 0.6249797900339504, 3: 0.125}
12 :  {0: 0.625, 1: 0.125, 2: 0.125, 3: 0.125}
13 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
14 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
15 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
16 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
17 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
18 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
19 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
20 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
21 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
22 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
23 :  {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}

Pi sums:
0 :  {0: 22674.800880309806, 1: 32288.520874891776, 2: 18688.347617100673, 3: 24636.330627697153}
1 :  {0: 10199.200961429031, 1: 19724.20172763579, 2: 8101.199179782639, 3: 9470.398131152642}
2 :  {0: 6182.884013275559, 1: 12536.780413690178, 2: 5014.8166932791555, 3: 5504.518879755164}
3 :  {0: 3365.5185516837373, 1: 8207.418061347504, 2: 2997.6188055178714, 3: 3199.4445814508504}
4 :  {0: 2023.067710325789, 1: 5767.141146454209, 2: 1853.8346175650493, 3: 1913.956525655165}
5 :  {0: 1309.7916059094634, 1: 4156.821867666922, 2: 1191.6141492506483, 3: 1232.772377172974}
6 :  {0: 864.0919475477449, 1: 3156.7597324737817, 2: 807.9675812465588, 3: 823.180738731917}
7 :  {0: 636.7992817646065, 1: 2417.25577562093, 2: 584.6360970548138, 3: 594.3088455596543}
8 :  {0: 435.977729902426, 1: 1894.5432228685136, 2: 420.8195980719104, 3: 427.6594491571496}
9 :  {0: 341.8396942659865, 1: 1542.1188294191552, 2: 330.1830320874486, 3: 333.85844422740877}
10 :  {0: 283.9289480412241, 1: 1373.9206194613425, 2: 281.9310280433199, 3: 282.219404454122}
11 :  {0: 433.9276597751559, 1: 1313.099146553732, 2: 965.5543292126729, 3: 391.41886445843943}
12 :  {0: 41172.55282248854, 1: 17564.17984827952, 2: 24727.307975561074, 3: 24616.959353671355}
13 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
14 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
15 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
16 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
17 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
18 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
19 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
20 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
21 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
22 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}
23 :  {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0}

Weights:
0 :  {0: 2.4456706046621497e+144, 1: 2.5293414482344124e+144, 2: 9.906109820656853e+118, 3: 3.08344232771807e+144}
1 :  {0: 6.259844912741968e+73, 1: 1.8889544685235966e+93, 2: 1.0, 3: 2.1459817539402148e+71}
2 :  {0: 8.187280844216573e+75, 1: 5.725799996587536e+93, 2: 1.0476249472964594, 3: 7.615703356442003e+60}
3 :  {0: 2.4268786493805513e+73, 1: 8.277389692088297e+93, 2: 1.046967745524681, 3: 4.860572587103846e+60}
4 :  {0: 1.976420933090896e+77, 1: 1.4745876836096312e+94, 2: 1.0465034351948703, 3: 3.2969909837345197e+61}
5 :  {0: 2.1288243282458325e+75, 1: 5.848024514234827e+96, 2: 1.046930072870053, 3: 2.4923891360281638e+60}
6 :  {0: 1.6798571052471067e+81, 1: 1.691868327262568e+95, 2: 1.0470022256029123, 3: 2.1704814344589955e+65}
7 :  {0: 8.260895874368701e+80, 1: 3.661922107417894e+95, 2: 1.0470401034158814, 3: 3.453751252307027e+60}
8 :  {0: 1.908170749718944e+80, 1: 4.78336803466487e+96, 2: 1.0490362168862455, 3: 3.592255904313933e+60}
9 :  {0: 2.3267967578735839e+83, 1: 1.0415744617186641e+101, 2: 1.0470489074318814, 3: 6.847553435016282e+67}
10 :  {0: 9.14428775074183e+94, 1: 1.3276265739346789e+106, 2: 1.0465034351948703, 3: 2.383798773958648e+78}
11 :  {0: 4.3330383511530706e+148, 1: 1.0397275948802915e+157, 2: 3.1417248222614947e+161, 3: 2.234796654514671e+115}
12 :  {0: 6.131121111248776e+105, 1: 1.0487380452680053, 2: 3.7834283076839053e+84, 3: 3.0457450364121515e+88}
13 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
14 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
15 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
16 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
17 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
18 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
19 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
20 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
21 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
22 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
23 :  {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}